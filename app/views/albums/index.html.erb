<%= title("Bildgalleri") %>
<%@carouselindex = 0%>
<div class="container">
    <div class="col-md-12">
    	<div class="row">
	    	<div class="headline headline-md">
	        	<h1>Bildgalleri</h1>
	    	</div>
    	</div>
    	<div class="row">
    		<div class="headline headline-md"><h3>Senast tillagda</h3></div>
	        <div class="row high-rated margin-bottom-20">
	            <!-- Easy Block -->                
            	<% if @albums_latest %>
	            	<% @albums_latest.each do |p| %>
	            	<div class="col-md-3">		            
						<%@album = p%>
						<%= render "album_preview"%>
					</div>
					<% end %>	
				<% end %>
			</div>
		</div> <!-- row-->
	<hr class="devider devider-dotted">

    	<div class="row">    
	    	<div class="headline headline-md"><h3>Sök efter album</h3></div>
	    	<%= form_tag index_albums_path, :method => 'post' do %>
			  		<div class="col-sm-4">					  			
			  			<div class="input-group">
			  				<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
			  				<%= date_field_tag(:datum,value = @datum, :class => 'form-control') %>
			  			</div>
		  			</div>
		  			<div class="col-sm-4">
		  				<div class="input-group">
		  					<span class="input-group-addon"><i class="fa fa-tag"></i></span>
		  					<%= select_tag :id, options_from_collection_for_select(@kategorier,:id,:name,@id ),:class => 'form-control', :include_blank => false%>
		  				</div>				  				
		  			</div>
		  			<div class="col-sm-4">			  				
		  					<%= submit_tag 'Visa', name: nil,:class => 'btn-u btn-block btn-u-dark'%>				  				
		  			</div>				  			
		  	<%end%>	  		
	  	</div>
	  	<hr class="devider devider-dotted">	
	  	<% if @searched %>
	  	<div class="row">
    		<div class="headline headline-md"><h3>Sökresultat</h3></div>
	        <div class="row high-rated margin-bottom-20">
	            <!-- Easy Block -->                
	            
	            	<% @albums.sort_by{|album|album.created_at}.reverse.slice(0,4).each do |p| %>
			            <%@album = p%>
						<%= render "album_preview"%>
					<% end %>	
			
		</div>
	</div>
	<hr class="devider devider-dotted">
	<% end %>
  	</div>
  	
  	<div class="container content">  		
		<div class="headline headline-md"><h3>Alla album</h3></div>
        <div class="row high-rated margin-bottom-20">
        	<div class="sorting-block">
	            <ul class="sorting-nav sorting-nav-v1 text-center">
	                <li class="filter active" data-filter="0">Alla</li>
		                <% @kategorier.each do |kat|%>
		                 <% if kat.name != " "%>
		                	<li class="filter" data-filter="<%=kat.id%>"><%=kat.name%></li>
		                 <% end %>
		                <% end %>		                
		            </ul>
                        	
            	     <%@row = 0%>        	
	                 <% @albums.each do |p| %>
		                 <%if (@row == 0)%>	            	
							<div class="row">
						<% end %>	                 
	                	<div class="col-md-3 album" data-cat="<%=@kategorier.where(:name => p.category).first.id%>">		                		
	                		<%@album = p%>
							<%= render "album_preview"%>
	                	</div>
	                	<% @row = @row+1%>						
						<%if (@row == 3)%>
							</div> <!--row-->
							<%@row = 0%>
						<% end %>
					<%end%>
					<% if @row > 0%>
						</div> <!--row-->
					<%end%>        		               
                    
            <div class="clearfix"></div>			
		</div>
	</div>
	<hr class="devider devider-dotted">	
  	</div>  	
</div>
  				  	
<script>
  	var albums = $('.album');
		
  $('.sorting-nav').on('click','li', function(){
   $(this).addClass('active').siblings().removeClass('active');
});
$('.sorting-nav').on('click','li', function() {	 
    var customType = $( this ).data('filter');

    if(customType > 0)
    {
    albums
        .hide()
        .filter(function () {
            return $(this).data('cat') === customType;
        })
        .show();
    }
    else 
    {
     albums.show();
    }
});

  	jQuery(documetn).ready(function() {
  		PortfolioPage.init();
  	})
</script>

  <% if current_user.admin? || current_user.has_role?(:galleri,:edit) %>
	<div class="headline headline-md">
		<h2>Verktyg</h2>
	</div>
    <ul class="list">
        <li><%= link_to "Skapa album", :new_album %></li>
        <li><%= link_to "Inställningar för galleri", :settings_albums %></li>
    </ul>
  <% end %>
 


